[
    {
        "id": "d117d1b62f7d086e",
        "type": "tab",
        "label": "Tradfri",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "1a8368cbbe1982c2",
        "type": "tab",
        "label": "Pi status",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b2fb63b9d77e15a7",
        "type": "tradfri-config",
        "name": "tradfri config",
        "gatewayHost": "10.1.0.36",
        "identity": "tradfri_1645005107424",
        "preSharedKey": "TTtltDuaoNFmlZHX"
    },
    {
        "id": "3ea589fd2b313663",
        "type": "catch",
        "z": "d117d1b62f7d086e",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 1140,
        "wires": [
            [
                "04c6ca6dc91092d7"
            ]
        ]
    },
    {
        "id": "04c6ca6dc91092d7",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 1140,
        "wires": []
    },
    {
        "id": "f28bc0dc4af57029",
        "type": "status",
        "z": "d117d1b62f7d086e",
        "name": "",
        "scope": null,
        "x": 60,
        "y": 1180,
        "wires": [
            [
                "42c920e8031cbe7c"
            ]
        ]
    },
    {
        "id": "42c920e8031cbe7c",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 1180,
        "wires": []
    },
    {
        "id": "94f9e5ca27ce82c1",
        "type": "http in",
        "z": "d117d1b62f7d086e",
        "name": "/tradfri/:device",
        "url": "/tradfri/:device",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 340,
        "y": 920,
        "wires": [
            [
                "039b8253b7696f59"
            ]
        ]
    },
    {
        "id": "7928829e1332e137",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "Mirror lamps",
        "props": [
            {
                "p": "req.params",
                "v": "{\"device\": \"Mirror lamps\"}",
                "vt": "json"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 350,
        "y": 860,
        "wires": [
            [
                "039b8253b7696f59"
            ]
        ]
    },
    {
        "id": "6ea96e84ddc1fb55",
        "type": "tradfri-monitor",
        "z": "d117d1b62f7d086e",
        "gateway": "b2fb63b9d77e15a7",
        "name": "",
        "x": 430,
        "y": 1140,
        "wires": [
            [
                "0768e54ac65e1ea0"
            ]
        ]
    },
    {
        "id": "4725435ee8826d82",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1140,
        "wires": []
    },
    {
        "id": "0768e54ac65e1ea0",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "try {\n    const globalDeviceList = {};\n    const name = msg.payload.name.toLowerCase()\n    globalDeviceList[name] = msg.payload\n\n    const newList = {\n        ...global.get(\"globalDeviceList\") || {},\n        ...globalDeviceList\n    }\n\n\n    global.set(\"globalDeviceList\", newList);\n    return { msg, deviceList: newList };\n} catch (err) {\n    node.error(err)\n    return {msg, err}\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 1140,
        "wires": [
            [
                "4725435ee8826d82"
            ]
        ]
    },
    {
        "id": "77f2a35b96e8c937",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "global.set(\"globalDeviceList\", undefined);\nreturn {info: \"Cleared globalDeviceList\"}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 1180,
        "wires": [
            [
                "8974dc3c7d79bbde"
            ]
        ]
    },
    {
        "id": "8974dc3c7d79bbde",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1180,
        "wires": []
    },
    {
        "id": "039b8253b7696f59",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "FindAndToggle",
        "func": "function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nfunction replaceAll(str, find, replace) {\n    return str.replace(new RegExp(escapeRegExp(find), 'g'), replace);\n}\n\nconst trimCommandString = (id) => ((id === 'all')\n    ? '' : replaceAll(id.replace(/the/g, '').trim().toLowerCase(), '_', ' '));\n\nconst toggle = (isOn) => (isOn ? \"off\" : \"on\")\n\nfunction main () {\n    const device = trimCommandString(\n        msg.req.params.device.toLowerCase()\n    )\n    const deviceList = global.get(\"globalDeviceList\")\n    node.warn(deviceList);\n    const deviceInfo = deviceList[device];\n    node.warn(deviceInfo);\n\n    const type = deviceInfo.type\n\n\n\n    return {\n        topic: deviceInfo.instanceId,\n        payload: toggle(deviceInfo[type].isOn),\n        res: msg.res\n    };\n}\n\ntry {\n    throw new Error(\"some error\")\n    return main();\n} catch (err) {\n    node.error(err)\n    return {\n        payload: err,\n        res: msg.res\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 920,
        "wires": [
            [
                "2e2c00ca72610f7c",
                "90b5126edab69b36",
                "69cec7f12a58fcb1"
            ]
        ]
    },
    {
        "id": "2e2c00ca72610f7c",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 980,
        "wires": []
    },
    {
        "id": "039a1cb7fbd844db",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 450,
        "y": 1180,
        "wires": [
            [
                "77f2a35b96e8c937"
            ]
        ]
    },
    {
        "id": "90b5126edab69b36",
        "type": "tradfri-switch-control",
        "z": "d117d1b62f7d086e",
        "gateway": "b2fb63b9d77e15a7",
        "name": "",
        "action": "",
        "accessories": [],
        "groups": [],
        "logInputErrors": true,
        "x": 760,
        "y": 920,
        "wires": []
    },
    {
        "id": "3bdafeedf173a283",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "the_tall_sofa_lamp",
        "props": [
            {
                "p": "req.params",
                "v": "{\"device\": \"tall sofa lamp\"}",
                "vt": "json"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 330,
        "y": 800,
        "wires": [
            [
                "039b8253b7696f59"
            ]
        ]
    },
    {
        "id": "bb9e3ac33d04a87a",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "living room",
        "props": [
            {
                "p": "req.params",
                "v": "{\"device\": \"living room\"}",
                "vt": "json"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 360,
        "y": 740,
        "wires": [
            [
                "039b8253b7696f59"
            ]
        ]
    },
    {
        "id": "69cec7f12a58fcb1",
        "type": "http response",
        "z": "d117d1b62f7d086e",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 710,
        "y": 860,
        "wires": []
    },
    {
        "id": "b1c7433538b40c08",
        "type": "http in",
        "z": "1a8368cbbe1982c2",
        "name": "/pistatus",
        "url": "/pistatus",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 260,
        "wires": [
            [
                "aec6a6ac7dcfb2fb"
            ]
        ]
    },
    {
        "id": "8be8c824b3a1a597",
        "type": "http response",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 660,
        "y": 220,
        "wires": []
    },
    {
        "id": "aec6a6ac7dcfb2fb",
        "type": "exec",
        "z": "1a8368cbbe1982c2",
        "command": "NOCOLOR=true ./Scripts/systemstatus",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 400,
        "y": 260,
        "wires": [
            [
                "8be8c824b3a1a597",
                "7d3e34a3aa784db9"
            ],
            [
                "7d3e34a3aa784db9"
            ],
            [
                "7d3e34a3aa784db9"
            ]
        ]
    },
    {
        "id": "7d3e34a3aa784db9",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 260,
        "wires": []
    },
    {
        "id": "0ec389efe231462f",
        "type": "catch",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 140,
        "y": 460,
        "wires": [
            [
                "ec1fa2cf27e2a7ea"
            ]
        ]
    },
    {
        "id": "ec1fa2cf27e2a7ea",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 460,
        "wires": []
    },
    {
        "id": "2641ff882a36271e",
        "type": "status",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "scope": null,
        "x": 140,
        "y": 500,
        "wires": [
            [
                "8809eb0acd5e381c"
            ]
        ]
    },
    {
        "id": "8809eb0acd5e381c",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 500,
        "wires": []
    }
]