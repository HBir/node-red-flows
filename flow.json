[
    {
        "id": "d117d1b62f7d086e",
        "type": "tab",
        "label": "Tradfri",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "1a8368cbbe1982c2",
        "type": "tab",
        "label": "Pi status",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b2fb63b9d77e15a7",
        "type": "tradfri-config",
        "name": "tradfri config",
        "gatewayHost": "10.1.0.36",
        "identity": "tradfri_1645005107424",
        "preSharedKey": "TTtltDuaoNFmlZHX"
    },
    {
        "id": "50afe6393fb38787",
        "type": "http in",
        "z": "d117d1b62f7d086e",
        "name": "/tradfri/mirror_lamps",
        "url": "/tradfri/mirror_lamps",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 520,
        "wires": [
            [
                "e51696fdf2c871ae",
                "636320b99392df67"
            ]
        ]
    },
    {
        "id": "3ea589fd2b313663",
        "type": "catch",
        "z": "d117d1b62f7d086e",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 60,
        "y": 1140,
        "wires": [
            [
                "04c6ca6dc91092d7"
            ]
        ]
    },
    {
        "id": "04c6ca6dc91092d7",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 1140,
        "wires": []
    },
    {
        "id": "f28bc0dc4af57029",
        "type": "status",
        "z": "d117d1b62f7d086e",
        "name": "",
        "scope": null,
        "x": 60,
        "y": 1180,
        "wires": [
            [
                "42c920e8031cbe7c"
            ]
        ]
    },
    {
        "id": "42c920e8031cbe7c",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 190,
        "y": 1180,
        "wires": []
    },
    {
        "id": "e51696fdf2c871ae",
        "type": "template",
        "z": "d117d1b62f7d086e",
        "name": "status",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "plain",
        "template": "status",
        "output": "str",
        "x": 290,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "628fcee036910b55",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "toggle",
        "func": "try {\n    return {topic: \"newstate\", payload: {onOff: !msg.payload.plugList[0].onOff}};\n} catch (err) {\n    node.error(\"Error\", err);\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 520,
        "wires": [
            [
                "9f939e5899deaeb0"
            ]
        ]
    },
    {
        "id": "636320b99392df67",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "msg.topic = \"http-initial\"\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 460,
        "wires": [
            [
                "9f939e5899deaeb0"
            ]
        ]
    },
    {
        "id": "9f939e5899deaeb0",
        "type": "join",
        "z": "d117d1b62f7d086e",
        "name": "",
        "mode": "custom",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "3",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 610,
        "y": 460,
        "wires": [
            [
                "0195ddb93b151dae",
                "84d209f2ad655824"
            ]
        ]
    },
    {
        "id": "0195ddb93b151dae",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 420,
        "wires": []
    },
    {
        "id": "344ecff5bbf8e055",
        "type": "http response",
        "z": "d117d1b62f7d086e",
        "name": "",
        "statusCode": "200",
        "headers": {
            "content-type": "application/json"
        },
        "x": 920,
        "y": 460,
        "wires": []
    },
    {
        "id": "84d209f2ad655824",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "const device = msg.payload[\"ikea-plugs\"]\nmsg.payload = { name: device.name, newStatus: msg.payload.newstate}\nnode.send(msg);",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 460,
        "wires": [
            [
                "344ecff5bbf8e055"
            ]
        ]
    },
    {
        "id": "94f9e5ca27ce82c1",
        "type": "http in",
        "z": "d117d1b62f7d086e",
        "name": "/tradfri/:device",
        "url": "/tradfri/:device",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 700,
        "wires": [
            [
                "46a4f78f13be1d63",
                "4a8ed55ecf72e67e",
                "d3a11f5fe55d9dca"
            ]
        ]
    },
    {
        "id": "46a4f78f13be1d63",
        "type": "tradfri-state",
        "z": "d117d1b62f7d086e",
        "gateway": "b2fb63b9d77e15a7",
        "name": "",
        "accessories": [],
        "groups": [],
        "logInputErrors": true,
        "x": 290,
        "y": 740,
        "wires": [
            [
                "4a8ed55ecf72e67e"
            ]
        ]
    },
    {
        "id": "4a8ed55ecf72e67e",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 430,
        "y": 680,
        "wires": []
    },
    {
        "id": "d3a11f5fe55d9dca",
        "type": "http response",
        "z": "d117d1b62f7d086e",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 300,
        "y": 620,
        "wires": []
    },
    {
        "id": "7928829e1332e137",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "",
        "props": [
            {
                "p": "req.params",
                "v": "{\"device\": \"Bedside table\"}",
                "vt": "json"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 310,
        "y": 980,
        "wires": [
            [
                "039b8253b7696f59"
            ]
        ]
    },
    {
        "id": "6ea96e84ddc1fb55",
        "type": "tradfri-monitor",
        "z": "d117d1b62f7d086e",
        "gateway": "b2fb63b9d77e15a7",
        "name": "",
        "x": 650,
        "y": 820,
        "wires": [
            [
                "0768e54ac65e1ea0"
            ]
        ]
    },
    {
        "id": "4725435ee8826d82",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 820,
        "wires": []
    },
    {
        "id": "0768e54ac65e1ea0",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "const globalDeviceList = {};\nglobalDeviceList[msg.payload.name.toLowerCase()] = {\n    instanceId: msg.topic,\n    state: msg.payload\n}\n\nconst newList = {\n    ...global.get(\"globalDeviceList\") || {},\n    ...globalDeviceList\n}\n\n\nglobal.set(\"globalDeviceList\", newList);\nreturn {msg, deviceList: newList};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 820,
        "wires": [
            [
                "4725435ee8826d82"
            ]
        ]
    },
    {
        "id": "77f2a35b96e8c937",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "global.set(\"globalDeviceList\", undefined);\nreturn {msg: \"Cleared globalDeviceList\"}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 860,
        "wires": [
            [
                "8974dc3c7d79bbde"
            ]
        ]
    },
    {
        "id": "8974dc3c7d79bbde",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 860,
        "wires": []
    },
    {
        "id": "039b8253b7696f59",
        "type": "function",
        "z": "d117d1b62f7d086e",
        "name": "",
        "func": "const device = msg.req.params.device.toLowerCase()\nconst deviceList = global.get(\"globalDeviceList\")\nnode.log(\"My Logggg\");\nconst deviceInfo = deviceList[device];\nreturn {msg: {deviceInfo}};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 980,
        "wires": [
            [
                "2e2c00ca72610f7c"
            ]
        ]
    },
    {
        "id": "2e2c00ca72610f7c",
        "type": "debug",
        "z": "d117d1b62f7d086e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 980,
        "wires": []
    },
    {
        "id": "039a1cb7fbd844db",
        "type": "inject",
        "z": "d117d1b62f7d086e",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 650,
        "y": 860,
        "wires": [
            [
                "77f2a35b96e8c937"
            ]
        ]
    },
    {
        "id": "b1c7433538b40c08",
        "type": "http in",
        "z": "1a8368cbbe1982c2",
        "name": "/pistatus",
        "url": "/pistatus",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 260,
        "wires": [
            [
                "aec6a6ac7dcfb2fb"
            ]
        ]
    },
    {
        "id": "8be8c824b3a1a597",
        "type": "http response",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 660,
        "y": 220,
        "wires": []
    },
    {
        "id": "aec6a6ac7dcfb2fb",
        "type": "exec",
        "z": "1a8368cbbe1982c2",
        "command": "NOCOLOR=true ./Scripts/systemstatus",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 400,
        "y": 260,
        "wires": [
            [
                "8be8c824b3a1a597",
                "7d3e34a3aa784db9"
            ],
            [
                "7d3e34a3aa784db9"
            ],
            [
                "7d3e34a3aa784db9"
            ]
        ]
    },
    {
        "id": "7d3e34a3aa784db9",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 260,
        "wires": []
    },
    {
        "id": "0ec389efe231462f",
        "type": "catch",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 140,
        "y": 460,
        "wires": [
            [
                "ec1fa2cf27e2a7ea"
            ]
        ]
    },
    {
        "id": "ec1fa2cf27e2a7ea",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 460,
        "wires": []
    },
    {
        "id": "2641ff882a36271e",
        "type": "status",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "scope": null,
        "x": 140,
        "y": 500,
        "wires": [
            [
                "8809eb0acd5e381c"
            ]
        ]
    },
    {
        "id": "8809eb0acd5e381c",
        "type": "debug",
        "z": "1a8368cbbe1982c2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 270,
        "y": 500,
        "wires": []
    }
]